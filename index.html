<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Match Counter — Simple Event Tracker</title>
<style>
  :root{font-family:Inter,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial;color:#eaeaea;background:#0f1720}
  body{margin:0;padding:18px;display:flex;flex-direction:column;gap:14px;min-height:100vh}
  .top{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
  .team{padding:10px 14px;border-radius:10px;cursor:pointer;user-select:none;background:#111827}
  .team.active{box-shadow:0 6px 18px rgba(0,0,0,.6);background:linear-gradient(180deg,#0b1220,#13202b)}
  .team input{background:transparent;border:0;color:inherit;font-weight:700;font-size:16px;width:170px}
  .actions{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:12px}
  .card{background:#0b1220;padding:14px;border-radius:12px;display:flex;flex-direction:column;gap:8px;min-height:90px}
  .act-title{font-size:14px;color:#9ca3af;display:flex;justify-content:space-between;align-items:center}
  .count{font-size:28px;font-weight:700}
  .controls{display:flex;gap:8px;align-items:center}
  button.btn{padding:8px 10px;border-radius:8px;border:0;background:#2563eb;color:white;cursor:pointer}
  button.ghost{background:transparent;border:1px solid #1f2937;color:#e5e7eb}
  .legend{font-size:13px;color:#9ca3af}
  footer{margin-top:auto;color:#9ca3af;font-size:13px}
  .kbd{background:#0b1220;border-radius:6px;padding:6px 8px;border:1px solid #1f2937;font-weight:700}
  @media (max-width:480px){.actions{grid-template-columns:repeat(2,1fr)}}
</style>
</head>
<body>
  <div class="top">
    <div class="team active" id="teamA">
      <div style="font-size:13px;color:#9ca3af">Team (klik / edit)</div>
      <input id="teamAName" value="Riverside Forest" />
    </div>
    <div class="team" id="teamB">
      <div style="font-size:13px;color:#9ca3af">Team (klik / edit)</div>
      <input id="teamBName" value="Bina Pakuan" />
    </div>

    <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
      <button class="btn" id="exportBtn">Export CSV (E)</button>
      <button class="ghost" id="resetBtn">Reset (R)</button>
    </div>
  </div>

  <div class="legend">
    Active team: <span id="activeLabel">Riverside Forest</span> — Shortcut: tekan <span class="kbd">1</span>.. <span class="kbd">6</span> untuk nambah aksi. Tekan <span class="kbd">Tab</span> untuk ganti tim.
  </div>

  <div class="actions" id="actions">
    <!-- cards generated by JS -->
  </div>

  <footer>
    Actions: <span class="kbd">1</span> Pass &nbsp; <span class="kbd">2</span> Shoot &nbsp; <span class="kbd">3</span> Tackle &nbsp; <span class="kbd">4</span> Foul &nbsp; <span class="kbd">5</span> Corner &nbsp; <span class="kbd">6</span> Save
  </footer>

<script>
(() => {
  const ACTIONS = ['Pass','Shoot','Tackle','Foul','Corner','Save'];
  const STORAGE_KEY = 'match_counter_state_v1';

  // initial state
  let state = {
    teamAName: 'Riverside Forest',
    teamBName: 'Bina Pakuan',
    active: 'A', // 'A' or 'B'
    counts: { A: [0,0,0,0,0,0], B: [0,0,0,0,0,0] }
  };

  // load saved
  try {
    const saved = localStorage.getItem(STORAGE_KEY);
    if (saved) Object.assign(state, JSON.parse(saved));
  } catch(e){ console.warn(e) }

  // DOM refs
  const actionsDiv = document.getElementById('actions');
  const activeLabel = document.getElementById('activeLabel');
  const exportBtn = document.getElementById('exportBtn');
  const resetBtn = document.getElementById('resetBtn');
  const teamAEl = document.getElementById('teamA');
  const teamBEl = document.getElementById('teamB');
  const teamANameInput = document.getElementById('teamAName');
  const teamBNameInput = document.getElementById('teamBName');

  function save() {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
  }

  function render() {
    actionsDiv.innerHTML = '';
    activeLabel.textContent = state.active === 'A' ? state.teamAName : state.teamBName;
    teamAEl.classList.toggle('active', state.active === 'A');
    teamBEl.classList.toggle('active', state.active === 'B');

    ACTIONS.forEach((act, i) => {
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <div class="act-title">
          <div>${act}</div>
          <div style="font-size:12px;color:#9ca3af">Key: <strong>${i+1}</strong></div>
        </div>
        <div style="display:flex;gap:10px;align-items:center;justify-content:space-between">
          <div>
            <div style="font-size:12px;color:#9ca3af">Team ${state.teamAName}</div>
            <div class="count" id="cA${i}">${state.counts.A[i]}</div>
          </div>
          <div>
            <div style="font-size:12px;color:#9ca3af">Team ${state.teamBName}</div>
            <div class="count" id="cB${i}">${state.counts.B[i]}</div>
          </div>
        </div>
        <div style="display:flex;gap:8px;margin-top:8px">
          <button class="btn" data-action="${i}" data-team="A">+ Team A</button>
          <button class="btn" data-action="${i}" data-team="B">+ Team B</button>
        </div>
      `;
      actionsDiv.appendChild(card);
    });

    // attach click handlers
    document.querySelectorAll('button[data-action]').forEach(btn=>{
      btn.onclick = () => {
        const i = Number(btn.getAttribute('data-action'));
        const t = btn.getAttribute('data-team');
        state.counts[t][i] += 1;
        save();
        render(); // update numbers
      };
    });
  }

  // keyboard handling
  window.addEventListener('keydown', (ev) => {
    // if focused on input, ignore except Tab handling
    const tag = document.activeElement.tagName;
    if (tag === 'INPUT' || tag === 'TEXTAREA') {
      if (ev.key === 'Tab') {
        ev.preventDefault();
        toggleTeam();
      }
      return;
    }

    if (ev.key === 'Tab') {
      ev.preventDefault();
      toggleTeam();
      return;
    }

    // numbers 1..6
    if (/^[1-6]$/.test(ev.key)) {
      const idx = Number(ev.key) - 1;
      const t = state.active;
      state.counts[t][idx] += 1;
      save();
      render();
      return;
    }

    // Export: E or e
    if (ev.key.toLowerCase() === 'e') {
      ev.preventDefault();
      exportCSV();
      return;
    }

    // Reset: R
    if (ev.key.toLowerCase() === 'r') {
      ev.preventDefault();
      if (confirm('Reset semua counter?')) resetAll();
      return;
    }
  });

  function toggleTeam() {
    state.active = state.active === 'A' ? 'B' : 'A';
    save();
    render();
  }

  teamAEl.addEventListener('click', () => { state.active='A'; save(); render(); teamANameInput.focus(); });
  teamBEl.addEventListener('click', () => { state.active='B'; save(); render(); teamBNameInput.focus(); });

  // update names
  teamANameInput.addEventListener('change', (e)=>{ state.teamAName=e.target.value||'Team A'; save(); render(); });
  teamBNameInput.addEventListener('change', (e)=>{ state.teamBName=e.target.value||'Team B'; save(); render(); });

  exportBtn.addEventListener('click', exportCSV);
  resetBtn.addEventListener('click', ()=>{ if(confirm('Reset semua counter?')) resetAll(); });

  function resetAll(){
    state.counts = { A: [0,0,0,0,0,0], B: [0,0,0,0,0,0] };
    save();
    render();
  }

  function exportCSV(){
    // build CSV: header + rows per action
    const rows = [];
    rows.push(['Action','Team', 'Count']);
    ACTIONS.forEach((a,i) => {
      rows.push([a, state.teamAName, state.counts.A[i]]);
      rows.push([a, state.teamBName, state.counts.B[i]]);
    });
    // also add totals
    const totalA = state.counts.A.reduce((s,n)=>s+n,0);
    const totalB = state.counts.B.reduce((s,n)=>s+n,0);
    rows.push([]); rows.push(['Total', state.teamAName, totalA]); rows.push(['Total', state.teamBName, totalB]);

    const csv = rows.map(r => r.map(v => `"${String(v).replace(/"/g,'""')}"`).join(',')).join('\r\n');
    const blob = new Blob([csv], {type: 'text/csv;charset=utf-8;'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    const fname = `${(state.teamAName || 'TeamA')}_vs_${(state.teamBName||'TeamB')}_events.csv`.replace(/\s+/g,'_');
    a.download = fname;
    document.body.appendChild(a);
    a.click();
    a.remove();
    URL.revokeObjectURL(url);
  }

  // init render
  render();
})();
</script>
</body>
</html>
